#!/bin/bash

# initialisation
ub='./usr/var/lib/proot-distro/installed-rootfs/ubuntu/root'

# bulk rename
ren() {
  readarray -t files <<< $(ls ~/scripts -1 --color=never)
  for ((i=0; i < "${#files[@]}"; i++)); do
  renammed=$(sed -E "s:$1:$2:g" <<< "${files[i]}")
    mv "${files[i]}" "$renammed" 2> /dev/null
  done
}

# average time of command
avg() {
  calc=0
  if [[ -z "$1" || -z "$2" ]]; then
    echo 'Usage : avg <times> <command>'
  else
    echo
    times="$1"
    command="${@:2}"
    for ((i=0; i < "$times"; i++)); do
      time=$((time $command > /dev/null 2>&1) 2>&1)
      calc+="+${time:8:-28}"
      echo -e "\e[A$i/$1"
    done
    time=$(bc <<< 'scale=3;('"$calc"')/'"$times"'*1000')
    echo -e "\e[A${time:0:-4}ms"
  fi
}

# zip content listing
7zl() {
  7za l "$1" | tail -n+21 | head -n-2 | awk '{print $5}' | grep -v -e ^'0'$ -e '.git/' -e 'node_modules/' | tail -n+2
}

# share files TO vm (PROOT-DISTRO)
shrvm() {
  cp -r "$1" "$ub"/
}

# get files FROM vm (PROOT-DISTRO)
getvm() {
  cp -r "$ub"/"$1" ~/
}

# shares files0 TO Shared folder (TERMUX)
shr() {
  if [[ -d /sdcard/Download/Shared ]]; then
    cp -r "$1" /sdcard/Download/Shared
  else
    echo "Feature only supported on termux"
  fi
}

# get files FROM Shared folder (TERMUX)
get() {
  if [[ -d /sdcard/Download/ ]]; then
    cp -r /sdcard/Download/"$1" ./
  else
    echo "Feature only supported on termux"
  fi
}

# move files TO Shared folder (TERMUX)
shrmv() {
  if [[ -d /sdcard/Download/Shared ]]; then
    mv "$1" /sdcard/Download/Shared/;
  else
    echo "Feature only supported on termux"
  fi
}

# move files FROM Shared folder (TERMUX)
getmv() {
  if [[ -d /sdcard/Download/ ]]; then
    mv /sdcard/Download/"$1" ./
  else
    echo "Feature only supported on termux"
  fi
}
