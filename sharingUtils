#!/bin/bash


# file uploader

up() {

  link=$(curl -s -F "file=@$1" "https://api.anonfiles.com/upload?token=$ANONFILES_API_KEY" \
  | egrep -o "https:\/\/anonfiles\.com\/[a-zA-Z0-9]{10}" | head -n 1)
  if [[ -z "$link" ]]; then
    echo "Failed"
    return
  fi
  printf "$1 > $link\n" >> ~/.temp/last/urls
  echo "$link"

}

anonfiles() {

  url "https://anonfiles.com/?p=1"

}

# url shortener

short() {

  # analysing input
  if [[ ! "$1" == *"http"* ]]; then
    input=$(echo https://"$1")
  else
    input="$1"
  fi
  input=$(sed 's/[/*^$]/\\&/g' <<< "$input")
#  echo "$input"

  # sending request + retrieving url
  link=$(curl -s --location --request POST 'https://u.nu/api/url/add' \
  --header 'Authorization: Bearer $UNU_API_KEY' \
  --header 'Content-Type: application/json' \
  --data-raw '{ "url": "'$input'" }' \
  | egrep -o "https:[\][/][\][/]u\.nu[\][/][a-zA-Z]{5}" | tr -d '\\')

  # logging url
  if [[ -z "$link" ]]; then
    echo "Failed"
    return
  fi
  printf "$1 > $link\n" >> ~/.temp/last/urls
  echo "$output"

}
